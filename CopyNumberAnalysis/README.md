# Copy Number Variants Analysis

Copy number calling for tumour samples with matched normal controls was done using the tool SEQUENZA v3.0.0 executed in python3 v3.8.8 and R v4.2.1. The R package copynumber v1.29.0.9 was used in combination with SEQUENZA to use the GRCh38 reference genome. BAM files from tumour/normal pairs were used as input data for this analysis. For PDX samples, BAM files with reads aligned against the GRCh38 reference genome and processed with XenofilteR (as described above) were used for analysis. Manual quality filtering of the outputs was performed, and all samples with a cellularity lower than 0.35 were excluded from follow-up analysis.  

Significant regions with frequent amplifications and deletions were identified using Gistic2 (V.2.0.23) with default parameters and using only one sample per patient. Segmentation data and copy number estimations retrieved from Sequenza were used as input. Regions were considered to be significant where estimated q-values were below 0.1. Focal and broad copy number scores per sample were obtained using the Web application CNApp (Franch-Expósito et al., 2020). CNApp was performed using default parameters and using SEQUENZA segmentation data as input, FCS and BCS profiles were compared between the patient tumour and PDX-X1 samples, and across mutational status groups (4WT, KIT, N/K/HRAS, NF1, and hailstorm status (absent vs present).

For tumour samples without matched normal controls, copy number calling was done using CNVkit (v0.9.10). Briefly, sex-specific reference profiles were generated using normal-against-normal copy number calling to filter out low quality normal samples, following the protocols described by Chandramohan, R. et al. (2022). Copy number alterations were called using the batch subcommand, gains were defined as segments with a log₂ ratio > 0.585, and losses as segments with a log₂ ratio < – 0.4. To reduce noise-related artifacts, we filtered samples based on signal variability: we calculated the median absolute deviation (MAD) of log₂ ratios for each sample, normalized this value based on segment length, and applied a modified z-score threshold of 3.5 to exclude outlier samples.